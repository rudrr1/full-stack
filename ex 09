<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product CRUD</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background-color: #f5f5f5; }
        h1 { text-align: center; color: #333; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        input { padding: 8px; margin: 5px 0; width: 100%; border-radius: 4px; border: 1px solid #ccc; }
        button { padding: 8px 12px; border: none; border-radius: 4px; background-color: #4CAF50; color: white; cursor: pointer; margin-top: 10px; }
        button:hover { background-color: #45a049; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #ddd; }
        .remove-btn { background-color: #f44336; padding: 5px 10px; border-radius: 4px; color: white; border: none; cursor: pointer; }
        .remove-btn:hover { background-color: #da190b; }
    </style>
</head>
<body>

<h1>Product CRUD Operations</h1>
<div class="container">
    <input type="hidden" id="productId">
    <input type="text" id="name" placeholder="Product Name">
    <input type="number" id="price" placeholder="Price">
    <input type="text" id="category" placeholder="Category">
    <button onclick="saveProduct()">Save Product</button>

    <table id="productTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Price</th>
                <th>Category</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Products will appear here -->
        </tbody>
    </table>
</div>

<script>
    const apiUrl = 'http://localhost:3000/products';

    async function fetchProducts() {
        const res = await fetch(apiUrl);
        const products = await res.json();
        displayProducts(products);
    }

    function displayProducts(products) {
        const tableBody = document.querySelector('#productTable tbody');
        tableBody.innerHTML = '';

        products.forEach(p => {
            const row = document.createElement('tr');

            row.innerHTML = `
                <td>${p.name}</td>
                <td>${p.price}</td>
                <td>${p.category}</td>
                <td>
                    <button onclick="editProduct('${p._id}', '${p.name}', ${p.price}, '${p.category}')">Edit</button>
                    <button class="remove-btn" onclick="deleteProduct('${p._id}')">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    function editProduct(id, name, price, category) {
        document.getElementById('productId').value = id;
        document.getElementById('name').value = name;
        document.getElementById('price').value = price;
        document.getElementById('category').value = category;
    }

    async function saveProduct() {
        const id = document.getElementById('productId').value;
        const name = document.getElementById('name').value;
        const price = document.getElementById('price').value;
        const category = document.getElementById('category').value;

        if (!name || !price || !category) {
            alert('Please fill all fields');
            return;
        }

        const productData = { name, price, category };

        if (id) {
            // Update
            await fetch(`${apiUrl}/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(productData)
            });
        } else {
            // Create
            await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(productData)
            });
        }

        document.getElementById('productId').value = '';
        document.getElementById('name').value = '';
        document.getElementById('price').value = '';
        document.getElementById('category').value = '';

        fetchProducts();
    }

    async function deleteProduct(id) {
        if (confirm('Are you sure you want to delete this product?')) {
            await fetch(`${apiUrl}/${id}`, { method: 'DELETE' });
            fetchProducts();
        }
    }

    // Initial fetch
    fetchProducts();
</script>

</body>
</html>
