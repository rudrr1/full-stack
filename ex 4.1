// employeeApp.js
const readline = require('readline');
const express = require('express');

const app = express();
const PORT = 3000;

// --- In-memory array to store employees ---
let employees = [];

// --- CLI Interface Setup ---
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

function showMenu() {
  console.log('\n=== Employee Management System ===');
  console.log('1. Add Employee');
  console.log('2. List Employees');
  console.log('3. Remove Employee');
  console.log('4. Exit');
  rl.question('Choose an option: ', handleMenu);
}

function handleMenu(option) {
  switch (option) {
    case '1':
      rl.question('Enter Employee Name: ', (name) => {
        rl.question('Enter Employee ID: ', (id) => {
          employees.push({ name, id });
          console.log(`âœ… Employee ${name} added!`);
          showMenu();
        });
      });
      break;
    case '2':
      console.log('\nğŸ“‹ Employee List:');
      if (employees.length === 0) console.log('No employees yet.');
      employees.forEach((e) => console.log(`- ${e.id}: ${e.name}`));
      showMenu();
      break;
    case '3':
      rl.question('Enter Employee ID to remove: ', (id) => {
        const index = employees.findIndex((e) => e.id === id);
        if (index >= 0) {
          console.log(`ğŸ—‘ï¸ Removed employee: ${employees[index].name}`);
          employees.splice(index, 1);
        } else {
          console.log('âŒ Employee not found.');
        }
        showMenu();
      });
      break;
    case '4':
      console.log('ğŸ‘‹ Exiting...');
      rl.close();
      process.exit(0);
      break;
    default:
      console.log('Invalid choice.');
      showMenu();
  }
}

// --- Start CLI ---
showMenu();

// --- Simple HTML Interface ---
app.get('/', (req, res) => {
  const html = `
    <html>
      <head><title>Employee Management</title></head>
      <body style="font-family: Arial; margin: 30px;">
        <h1>Employee List</h1>
        <ul>
          ${employees.map(e => `<li>${e.id} - ${e.name}</li>`).join('')}
        </ul>
        <p><i>Use the CLI in terminal to add or remove employees.</i></p>
      </body>
    </html>
  `;
  res.send(html);
});

app.listen(PORT, () => {
  console.log(`ğŸŒ Web view running at http://localhost:${PORT}`);
});
